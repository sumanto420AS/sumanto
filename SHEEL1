    <?php
    //Default Configuration
    $CONFIG = '{"lang":"en","error_reporting":false,"show_hidden":false,"hide_Cols":false,"theme":"light"}';

    /**
     * H3K | Tiny File Manager V2.5.3
     * @author CCP Programmers
     * @email ccpprogrammers@gmail.com
     * @github https://github.com/prasathmani/tinyfilemanager
     * @link https://tinyfilemanager.github.io
     */

    //TFM version
    define('VERSION', '2.5.3');

    //Application Title
    define('APP_TITLE', 'Admin Panel Login');

    // --- EDIT BELOW CONFIGURATION CAREFULLY ---

    // Auth with login/password
    // set true/false to enable/disable it
    // Is independent from IP white- and blacklisting
    $use_auth = true;

    $auth_users = array(
        'bapet' => '$2y$10$/MC4UgUvtCNnHPyUve14F.4OY8rskrbM0ATWfG5HlXFzsvisLepZy'
    );

    // Readonly users
    // e.g. array('users', 'guest', ...)
    $readonly_users = array(
        'user'
    );

    // Global readonly, including when auth is not being used
    $global_readonly = false;

    // user specific directories
    // array('Username' => 'Directory path', 'Username2' => 'Directory path', ...)
    $directories_users = array();

    // Enable highlight.js (https://highlightjs.org/) on view's page
    $use_highlightjs = true;

    // highlight.js style
    // for dark theme use 'ir-black'
    $highlightjs_style = 'vs';

    // Enable ace.js (https://ace.c9.io/) on view's page
    $edit_files = true;

    // Default timezone for date() and time()
    // Doc - http://php.net/manual/en/timezones.php
    $default_timezone = 'Etc/UTC'; // UTC

    // Root path for file manager
    // use absolute path of directory i.e: '/var/www/folder' or $_SERVER['DOCUMENT_ROOT'].'/folder'
    $root_path = $_SERVER['DOCUMENT_ROOT'];

    // Root url for links in file manager.Relative to $http_host. Variants: '', 'path/to/subfolder'
    // Will not working if $root_path will be outside of server document root
    $root_url = '';

    // Server hostname. Can set manually if wrong
    // $_SERVER['HTTP_HOST'].'/folder'
    $http_host = $_SERVER['HTTP_HOST'];

    // input encoding for iconv
    $iconv_input_encoding = 'UTF-8';

    // date() format for file modification date
    // Doc - https://www.php.net/manual/en/function.date.php
    $datetime_format = 'm/d/Y g:i A';

    // Path display mode when viewing file information
    // 'full' => show full path
    // 'relative' => show path relative to root_path
    // 'host' => show path on the host
    $path_display_mode = 'full';

    // Allowed file extensions for create and rename files
    // e.g. 'txt,html,css,js'
    $allowed_file_extensions = '';

    // Allowed file extensions for upload files
    // e.g. 'gif,png,jpg,html,txt'
    $allowed_upload_extensions = '';

    // Favicon path. This can be either a full url to an .PNG image, or a path based on the document root.
    // full path, e.g http://example.com/favicon.png
    // local path, e.g images/icons/favicon.png
    $favicon_path = '';

    // Files and folders to excluded from listing
    // e.g. array('myfile.html', 'personal-folder', '*.php', ...)
    $exclude_items = array();

    // Online office Docs Viewer
    // Availabe rules are 'google', 'microsoft' or false
    // Google => View documents using Google Docs Viewer
    // Microsoft => View documents using Microsoft Web Apps Viewer
    // false => disable online doc viewer
    $online_viewer = 'google';

    // Sticky Nav bar
    // true => enable sticky header
    // false => disable sticky header
    $sticky_navbar = true;

    // Maximum file upload size
    // Increase the following values in php.ini to work properly
    // memory_limit, upload_max_filesize, post_max_size
    $max_upload_size_bytes = 5000000000; // size 5,000,000,000 bytes (~5GB)

    // chunk size used for upload
    // eg. decrease to 1MB if nginx reports problem 413 entity too large
    $upload_chunk_size_bytes = 2000000; // chunk size 2,000,000 bytes (~2MB)

    // Possible rules are 'OFF', 'AND' or 'OR'
    // OFF => Don't check connection IP, defaults to OFF
    // AND => Connection must be on the whitelist, and not on the blacklist
    // OR => Connection must be on the whitelist, or not on the blacklist
    $ip_ruleset = 'OFF';

    // Should users be notified of their block?
    $ip_silent = true;

    // IP-addresses, both ipv4 and ipv6
    $ip_whitelist = array(
        '127.0.0.1',    // local ipv4
        '::1'           // local ipv6
    );

    // IP-addresses, both ipv4 and ipv6
    $ip_blacklist = array(
        '0.0.0.0',      // non-routable meta ipv4
        '::'            // non-routable meta ipv6
    );

    // if User has the external config file, try to use it to override the default config above [config.php]
    // sample config - https://tinyfilemanager.github.io/config-sample.txt
    $config_file = __DIR__.'/config.php';
    if (is_readable($config_file)) {
        @include($config_file);
    }

    // External CDN resources that can be used in the HTML (replace for GDPR compliance)
    $external = array(
        'css-bootstrap' => '<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">',
        'css-dropzone' => '<link href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/min/dropzone.min.css" rel="stylesheet">',
        'css-font-awesome' => '<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">',
        'css-highlightjs' => '<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/' . $highlightjs_style . '.min.css">',
        'js-ace' => '<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.13.1/ace.js"></script>',
        'js-bootstrap' => '<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>',
        'js-dropzone' => '<script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/min/dropzone.min.js"></script>',
        'js-jquery' => '<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>',
        'js-jquery-datatables' => '<script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js" crossorigin="anonymous" defer></script>',
        'js-highlightjs' => '<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>',
        'pre-jsdelivr' => '<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin/><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"/>',
        'pre-cloudflare' => '<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin/><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com"/>'
    );

    // --- EDIT BELOW CAREFULLY OR DO NOT EDIT AT ALL ---

    // max upload file size
    define('MAX_UPLOAD_SIZE', $max_upload_size_bytes);

    // upload chunk size
    define('UPLOAD_CHUNK_SIZE', $upload_chunk_size_bytes);

    // private key and session name to store to the session
    if ( !defined( 'FM_SESSION_ID')) {
        define('FM_SESSION_ID', 'filemanager');
    }

    // Configuration
    $cfg = new FM_Config();

    // Default language
    $lang = isset($cfg->data['lang']) ? $cfg->data['lang'] : 'en';

    // Show or hide files and folders that starts with a dot
    $show_hidden_files = isset($cfg->data['show_hidden']) ? $cfg->data['show_hidden'] : true;

    // PHP error reporting - false = Turns off Errors, true = Turns on Errors
    $report_errors = isset($cfg->data['error_reporting']) ? $cfg->data['error_reporting'] : true;

    // Hide Permissions and Owner cols in file-listing
    $hide_Cols = isset($cfg->data['hide_Cols']) ? $cfg->data['hide_Cols'] : true;

    // Theme
    $theme = isset($cfg->data['theme']) ? $cfg->data['theme'] : 'light';

    define('FM_THEME', $theme);

    //available languages
    $lang_list = array(
        'en' => 'English'
    );

    if ($report_errors == true) {
        @ini_set('error_reporting', E_ALL);
        @ini_set('display_errors', 1);
    } else {
        @ini_set('error_reporting', E_ALL);
        @ini_set('display_errors', 0);
    }

    // if fm included
    if (defined('FM_EMBED')) {
        $use_auth = false;
        $sticky_navbar = false;
    } else {
        @set_time_limit(600);

        date_default_timezone_set($default_timezone);

        ini_set('default_charset', 'UTF-8');
        if (version_compare(PHP_VERSION, '5.6.0', '<') && function_exists('mb_internal_encoding')) {
            mb_internal_encoding('UTF-8');
        }
        if (function_exists('mb_regex_encoding')) {
            mb_regex_encoding('UTF-8');
        }

        session_cache_limiter('nocache'); // Prevent logout issue after page was cached
        session_name(FM_SESSION_ID );
        function session_error_handling_function($code, $msg, $file, $line) {
            // Permission denied for default session, try to create a new one
            if ($code == 2) {
                session_abort();
                session_id(session_create_id());
                @session_start();
            }
        }
        set_error_handler('session_error_handling_function');
        session_start();
        restore_error_handler();
    }

    //Generating CSRF Token
    if (empty($_SESSION['token'])) {
        if (function_exists('random_bytes')) {
            $_SESSION['token'] = bin2hex(random_bytes(32));
        } else {
            $_SESSION['token'] = bin2hex(openssl_random_pseudo_bytes(32));
        }
    }

    if (empty($auth_users)) {
        $use_auth = false;
    }

    $is_https = isset($_SERVER['HTTPS']) && ($_SERVER['HTTPS'] == 'on' || $_SERVER['HTTP
